<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Nh·∫≠t k√Ω chuy·∫øn tham quan ƒê√† L·∫°t c·ªßa l·ªõp 11L - K·ª∑ ni·ªám ƒë√°ng nh·ªõ">
<title>Nh·∫≠t K√Ω ƒê√† L·∫°t ¬∑ L·ªõp 11L</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;0,800;1,400&family=Lora:ital,wght@0,400;0,500;0,600;1,400;1,500&family=Dancing+Script:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --forest-dark:#1e4430; --forest-green:#1a3c28; --leaf-green:#204e34;
  --mint-light:#2d5a40; --cream:#f9f7f0; --page-white:#fffef9;
  --ink-dark:#2c3e2c; --gold-accent:#c9a961; --beige:#d4b896;
  --g9:#162c1e; --g8:#1c3826; --g7:#24482e; --g6:#305c3a;
  --g5:#3e7249; --g4:#568c62; --g3:#7aaa88; --g2:#aeceba;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;overflow-x:hidden;}

body{cursor:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="8" fill="%233e7249" opacity="0.3"/></svg>') 10 10, auto;}

body{
  font-family:'Lora',serif;
  background:
    radial-gradient(ellipse at 50% 20%, rgba(62,114,73,.12), transparent 60%),
    radial-gradient(ellipse at 80% 70%, rgba(30,68,48,.08), transparent 50%),
    radial-gradient(ellipse at 20% 80%, rgba(45,90,64,.1), transparent 55%),
    linear-gradient(180deg, #e8f4ed 0%, #d4e8dc 25%, #c5ddd0 50%, #d0e3d8 75%, #ddeee5 100%);
  min-height:100vh;
  display:flex;flex-direction:column;align-items:center;
  padding:40px 20px;
  position:relative;overflow-x:hidden;
}
body::before{
  content:'';position:fixed;inset:0;
  background-image:
    repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(122,170,136,.018) 3px,rgba(122,170,136,.018) 6px),
    repeating-linear-gradient(90deg,transparent,transparent 3px,rgba(122,170,136,.022) 3px,rgba(122,170,136,.022) 6px),
    radial-gradient(circle at 15% 25%,rgba(62,114,73,.04),transparent 45%),
    radial-gradient(circle at 85% 75%,rgba(62,114,73,.04),transparent 45%);
  opacity:.85;pointer-events:none;z-index:0;
  animation:paperGrain 12s ease-in-out infinite;
}
@keyframes paperGrain{0%,100%{opacity:.85;}50%{opacity:.65;}}
body::after{
  content:'';position:fixed;inset:0;
  background-image:
    radial-gradient(2px 2px at 12% 18%,rgba(201,169,97,.22),transparent),
    radial-gradient(1px 1px at 28% 45%,rgba(255,255,255,.12),transparent),
    radial-gradient(2px 2px at 58% 12%,rgba(201,169,97,.28),transparent),
    radial-gradient(1px 1px at 78% 68%,rgba(255,255,255,.14),transparent),
    radial-gradient(1px 1px at 22% 82%,rgba(201,169,97,.20),transparent),
    radial-gradient(2px 2px at 88% 38%,rgba(255,255,255,.16),transparent),
    radial-gradient(1px 1px at 45% 55%,rgba(201,169,97,.18),transparent),
    radial-gradient(2px 2px at 65% 75%,rgba(255,255,255,.12),transparent);
  animation:particlesDrift 35s linear infinite, particlesTwinkle 4s ease-in-out infinite;
  pointer-events:none;opacity:.5;z-index:1;
}
@keyframes particlesDrift{from{transform:translateY(0) translateX(0);}to{transform:translateY(-90px) translateX(50px);}}
@keyframes particlesTwinkle{0%,100%{opacity:.5;}50%{opacity:.7;}}

/* ‚îÄ‚îÄ CURSOR TRAIL ‚Äî smoother, GPU-composited ‚îÄ‚îÄ */
.cursor-trail {
  position: fixed;
  width: 7px; height: 7px; border-radius: 50%;
  background: radial-gradient(circle, rgba(62,114,73,0.65), rgba(122,170,136,0.28));
  pointer-events: none; z-index: 9999;
  will-change: transform, opacity;
  animation: trailFade 0.6s cubic-bezier(.4,0,.2,1) forwards;
  box-shadow: 0 0 8px rgba(62,114,73,0.35);
  transform: translate(-50%, -50%);
}
@keyframes trailFade { to { opacity: 0; transform: translate(-50%,-50%) scale(0.2); } }

.progress-bar-container {
  position: fixed; top: 0; left: 0; right: 0; height: 3px;
  background: rgba(30,68,48,.08); z-index: 10000; opacity: 0;
  transition: opacity .2s ease;
}
.progress-bar-container.active { opacity: 1; }
.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #2d5a40, #3e7249, #568c62);
  width: 0%;
  transition: width .3s cubic-bezier(.4,0,.2,1);
  box-shadow: 0 0 8px rgba(62,114,73,.5);
}

.breadcrumb {
  position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
  background: rgba(255,255,255,.92); backdrop-filter: blur(12px);
  padding: 7px 22px; border-radius: 30px;
  border: 2px solid rgba(62,114,73,.22);
  font-family: 'Playfair Display', serif; font-size: 0.8rem;
  color: var(--forest-dark); z-index: 9998; opacity: 0; pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
  box-shadow: 0 4px 14px rgba(30,68,48,.12);
  white-space: nowrap; max-width: calc(100vw - 180px);
  overflow: hidden; text-overflow: ellipsis;
}
.breadcrumb.visible { opacity: 1; pointer-events: auto; }

.home-btn {
  position: fixed; top: 20px; left: 20px;
  display: flex; align-items: center; gap: 6px;
  padding: 8px 16px;
  background: rgba(255,255,255,.92); backdrop-filter: blur(12px);
  border: 2px solid rgba(62,114,73,.28); border-radius: 30px;
  font-family: 'Playfair Display', serif; font-size: 0.82rem;
  color: var(--forest-dark); cursor: pointer; z-index: 9999;
  text-decoration: none;
  box-shadow: 0 4px 14px rgba(30,68,48,.12);
  transition: background .18s ease, border-color .18s ease, transform .18s ease, box-shadow .18s ease;
}
.home-btn:hover {
  background: rgba(62,114,73,.12); border-color: rgba(62,114,73,.55);
  transform: translateY(-2px); box-shadow: 0 8px 20px rgba(30,68,48,.18);
}

.sr-announce {
  position: absolute; left: -9999px; width: 1px; height: 1px;
  overflow: hidden; clip: rect(0,0,0,0);
}

.book-container{
  position:relative;max-width:1100px;width:100%;
  perspective:2000px;z-index:10;
  animation:containerFadeIn .9s cubic-bezier(.22,1,.36,1) both;
}
@keyframes containerFadeIn{
  from{opacity:0;transform:translateY(36px) scale(.97);}
  to{opacity:1;transform:translateY(0) scale(1);}
}

/* ‚îÄ‚îÄ BOOK COVER ‚îÄ‚îÄ */
.book-cover{
  position:relative;
  background:
    repeating-linear-gradient(45deg,rgba(30,68,48,.08),rgba(30,68,48,.08) 3px,transparent 3px,transparent 6px),
    linear-gradient(135deg,#1e4430 0%,#1a3c28 30%,#204e34 60%,#172e1e 85%,#112218 100%);
  border-radius:8px;
  padding:60px 55px;
  box-shadow:0 30px 80px rgba(0,0,0,.6),inset 0 0 150px rgba(0,0,0,.4),inset 2px 2px 8px rgba(255,255,255,.1),inset -2px -2px 8px rgba(0,0,0,.4);
  border:8px ridge rgba(30,68,48,.5);
  margin-bottom:40px;
  transform-style:preserve-3d;
  will-change:transform;
  animation:bookEntrance 1.1s cubic-bezier(.22,1,.36,1) both;
  overflow:visible;
  transition: transform .18s cubic-bezier(.22,1,.36,1);
}
.book-cover:hover{
  transform: translateY(-4px) scale(1.008);
}
.book-cover:active{
  transform: translateY(-1px) scale(1.003);
  transition-duration: .08s;
}
@keyframes bookEntrance{
  0%  {opacity:0;transform:rotateX(-28deg) translateY(-90px) scale(.86);}
  55% {opacity:1;transform:rotateX(6deg)  translateY(10px)   scale(1.03);}
  75% {transform:rotateX(-2deg) translateY(-4px) scale(1.01);}
  100%{opacity:1;transform:rotateX(0) translateY(0) scale(1);}
}
.book-cover::before{
  content:'';position:absolute;left:-15px;top:5%;bottom:5%;width:25px;
  background:linear-gradient(90deg,rgba(0,0,0,.6),rgba(30,68,48,.4) 30%,transparent);
  border-radius:4px 0 0 4px;box-shadow:inset 2px 0 5px rgba(0,0,0,.5);
}
/* embossGlow: ch·ªâ d√πng opacity ‚Äî GPU only, kh√¥ng repaint */
.book-cover::after{
  content:'';position:absolute;inset:22px;
  border:3px double rgba(201,169,97,.6);border-radius:4px;
  box-shadow:inset 0 0 60px rgba(201,169,97,.28),0 0 38px rgba(201,169,97,.45),inset 2px 2px 4px rgba(255,255,255,.15),inset -2px -2px 4px rgba(0,0,0,.3);
  animation:embossGlow 3.5s ease-in-out infinite;pointer-events:none;
  will-change:opacity;
}
@keyframes embossGlow{
  0%,100%{opacity:.65;}
  50%    {opacity:1;}
}

.ff-wrap{position:absolute;inset:0;pointer-events:none;z-index:1;overflow:hidden;}
.ff{position:absolute;border-radius:50%;pointer-events:none;
  will-change:transform,opacity;
  animation:ffRise var(--dur) var(--del) cubic-bezier(.4,0,.6,1) infinite;opacity:0;}
@keyframes ffRise{
  0%  {opacity:0;transform:translateY(0)     translateX(0)   scale(1);}
  15% {opacity:.88;}
  80% {opacity:.32;}
  100%{opacity:0;transform:translateY(-130px) translateX(var(--dx)) scale(.2);}
}

.bookmark{
  position:absolute;top:0;right:12%;width:52px;height:160px;
  background:linear-gradient(135deg,#2d5a40,#3e7249);
  clip-path:polygon(0 0,100% 0,100% 75%,50% 100%,0 75%);
  box-shadow:0 12px 35px rgba(30,68,48,.6),inset 0 2px 0 rgba(255,255,255,.4);
  z-index:3;
  will-change:transform;
  animation:bookmarkSway 4s cubic-bezier(.45,.05,.55,.95) infinite;
}
.bookmark::before{content:'üåø';position:absolute;top:16px;left:50%;transform:translateX(-50%);font-size:1.6rem;
  animation:leafSpin 7s linear infinite;will-change:transform;}
@keyframes bookmarkSway{0%,100%{transform:rotate(0) translateY(0);}50%{transform:rotate(3.5deg) translateY(-2px);}}
@keyframes leafSpin{from{transform:translateX(-50%) rotate(0);}to{transform:translateX(-50%) rotate(360deg);}}

.cover-content{position:relative;z-index:2;text-align:center;color:var(--cream);}

/* badgeShimmer: opacity thay v√¨ box-shadow ‚Äî kh√¥ng repaint */
.cover-badge{
  display:inline-flex;align-items:center;gap:8px;
  background:rgba(62,114,73,.14);border:1px solid rgba(62,114,73,.34);
  color:var(--g2);padding:8px 26px;border-radius:50px;
  font-size:.82rem;font-family:'Playfair Display',serif;letter-spacing:.18em;
  margin-bottom:22px;
  animation:fU .7s cubic-bezier(.22,1,.36,1) .05s both, badgeShimmer 2.4s ease-in-out infinite;
  will-change:transform,opacity;
  box-shadow: 0 0 22px rgba(122,170,136,0.35);
}
@keyframes badgeShimmer {
  0%, 100% { opacity: .8; }
  50% { opacity: 1; }
}

/* icon ƒë∆°n gi·∫£n ‚Äî kh√¥ng float, kh√¥ng wrapper n·∫∑ng */
.cover-icon-wrap{
  display:inline-block;
  margin-bottom:26px;
  animation:fU .7s cubic-bezier(.22,1,.36,1) .18s both;
}
.cover-icon{
  font-size:7rem;display:inline-block;
  filter:drop-shadow(0 8px 20px rgba(62,114,73,.65)) drop-shadow(0 0 24px rgba(201,169,97,.4));
  will-change:auto;
}

.cover-title{
  font-family:'Playfair Display',serif;font-size:5rem;font-weight:800;
  margin-bottom:20px;letter-spacing:.08em;
  text-shadow:0 0 40px rgba(62,114,73,.9),0 6px 20px rgba(0,0,0,.8),0 0 90px rgba(201,169,97,.6),2px 2px 0 rgba(0,0,0,.3);
  animation:titleFloat 5.5s cubic-bezier(.45,.05,.55,.95) infinite, fU .7s cubic-bezier(.22,1,.36,1) .3s both;
  will-change:transform;
}
@keyframes titleFloat{0%,100%{transform:translateY(0);}50%{transform:translateY(-7px);}}

.cover-subtitle{
  font-family:'Dancing Script',cursive;font-size:2.2rem;
  margin-bottom:36px;opacity:.95;
  text-shadow:0 4px 15px rgba(0,0,0,.7);
  animation:fU .7s cubic-bezier(.22,1,.36,1) .44s both;
  will-change:transform,opacity;
}
.cover-quote{
  font-size:1.1rem;line-height:1.9;max-width:650px;margin:0 auto 44px;
  opacity:.92;font-style:italic;font-family:'Lora',serif;
  text-shadow:0 2px 10px rgba(0,0,0,.5);
  animation:fU .7s cubic-bezier(.22,1,.36,1) .56s both;
  will-change:transform,opacity;
}

/* btnPulse: d√πng scale+opacity thay v√¨ box-shadow ‚Äî GPU only */
.open-book-btn{
  display:inline-block;padding:15px 45px;
  background: linear-gradient(135deg,#2d5a40,#3e7249);
  color:#fff;text-decoration:none;font-weight:700;font-size:1.05rem;border-radius:50px;
  box-shadow:0 14px 38px rgba(30,68,48,.65),inset 0 2px 0 rgba(255,255,255,.5),0 0 44px rgba(62,114,73,.45);
  transition:transform .13s cubic-bezier(.22,1,.36,1), opacity .13s ease, border-color .13s ease, letter-spacing .13s ease;
  animation:fU .7s cubic-bezier(.22,1,.36,1) .68s both, btnPulse 2.8s ease-in-out infinite;
  font-family:'Playfair Display',serif;letter-spacing:.06em;
  border:3px solid rgba(201,169,97,.5);
  position:relative;overflow:hidden;cursor:pointer;
  will-change:transform,opacity;
}
.open-book-btn:hover{
  transform:translateY(-6px) scale(1.07);
  border-color:rgba(201,169,97,1);
  opacity:1;
  letter-spacing:.09em;
}
.open-book-btn:active{transform:translateY(-2px) scale(1.02);transition-duration:.07s;}
.open-book-btn:focus { outline: 3px solid rgba(201,169,97,.8); outline-offset: 4px; }
.open-book-btn::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;
  background:radial-gradient(circle,rgba(255,255,255,.55),transparent 70%);
  border-radius:50%;transform:translate(-50%,-50%);transition:width .45s ease,height .45s ease;}
.open-book-btn:hover::before{width:400px;height:400px;}
/* btnPulse: ch·ªâ scale ‚Äî GPU composite layer, 0 repaint */
@keyframes btnPulse{
  0%,100%{transform:scale(1);}
  50%{transform:scale(1.025);}
}
@keyframes fU{from{opacity:0;transform:translateY(22px);}to{opacity:1;transform:translateY(0);}}
.open-book-btn span{position:relative;z-index:1;}

/* ‚îÄ‚îÄ BOOK PAGES ‚îÄ‚îÄ */
.book-pages{
  position:relative;
  background:linear-gradient(135deg,#f9f7f0 0%,#f5f2ea 50%,#ede8dc 100%);
  border-radius:12px;
  box-shadow:0 25px 70px rgba(30,68,48,.35),inset 0 0 120px rgba(249,247,240,.6);
  overflow:hidden;
  animation:bookPagesOpen .85s cubic-bezier(.4,0,.2,1);
}
@keyframes bookPagesOpen{
  from{opacity:0;transform:perspective(1000px) rotateY(-12deg) scale(.97);}
  to{opacity:1;transform:perspective(1000px) rotateY(0) scale(1);}
}

/* ‚îÄ‚îÄ PAGE ‚îÄ‚îÄ */
.page{
  background:
    repeating-linear-gradient(0deg,transparent,transparent 27px,rgba(201,169,97,.06) 27px,rgba(201,169,97,.06) 28px),
    linear-gradient(135deg,#f9f7f0 0%,#f5ebe0 50%,#ede8dc 100%);
  padding:70px 90px 100px;
  min-height:600px;
  position:relative;
  border-left:60px solid rgba(30,68,48,.08);
  animation:pageTurn .75s cubic-bezier(.4,0,.2,1);
  transform-origin:left center;
  box-shadow:inset 0 0 100px rgba(30,68,48,.05);
  will-change:opacity,transform;
}
@keyframes pageTurn{
  0%  {opacity:0;transform:perspective(1800px) rotateY(-6deg) translateY(12px);}
  55% {transform:perspective(1800px) rotateY(1.5deg) translateY(-3px);}
  100%{opacity:1;transform:perspective(1800px) rotateY(0) translateY(0);}
}
.page::before{
  content:'';position:absolute;inset:0;
  background-image:
    radial-gradient(ellipse at 15% 20%,rgba(62,114,73,.08),transparent 35%),
    radial-gradient(ellipse at 85% 80%,rgba(30,68,48,.06),transparent 40%),
    radial-gradient(circle at 50% 10%,rgba(201,169,97,.08),transparent 30%),
    radial-gradient(circle at 30% 70%,rgba(62,114,73,.05),transparent 25%);
  pointer-events:none;animation:agingSpots 15s ease-in-out infinite;
}
@keyframes agingSpots{0%,100%{opacity:.6;}50%{opacity:.8;}}
.page::after{
  content:'';position:absolute;left:24px;top:50%;transform:translateY(-50%);
  width:10px;height:85%;
  background:
    radial-gradient(circle,rgba(30,68,48,.25) 40%,rgba(0,0,0,.08) 40%,transparent 45%),
    radial-gradient(circle,rgba(30,68,48,.25) 40%,rgba(0,0,0,.08) 40%,transparent 45%),
    radial-gradient(circle,rgba(30,68,48,.25) 40%,rgba(0,0,0,.08) 40%,transparent 45%);
  background-size:10px 10px;
  background-position:0 0,0 50%,0 100%;
  background-repeat:no-repeat;
  filter:drop-shadow(1px 1px 2px rgba(0,0,0,.2));
}

.leaf-layer{position:absolute;inset:0;pointer-events:none;overflow:hidden;z-index:1;}
.lf{position:absolute;font-size:var(--lsz);pointer-events:none;
  animation:lfDrift var(--ldur) var(--ldel) ease-in-out infinite;opacity:0;
  will-change: transform, opacity;}
@keyframes lfDrift{
  0%  {opacity:0;transform:translateY(20px) translateX(0) rotate(0deg) scale(1);}
  18% {opacity:.52;}82%{opacity:.25;}
  100%{opacity:0;transform:translateY(-140px) translateX(var(--lx)) rotate(200deg) scale(.3);}
}

.page-content{position:relative;z-index:1;}

.page-number{
  position:absolute;bottom:28px;right:45px;
  font-family:'Dancing Script',cursive;font-size:1.35rem;
  color:var(--g5);
  background:rgba(249,247,240,.6);
  padding:6px 16px;border-radius:50px;
  border:2px solid rgba(62,114,73,.25);
  box-shadow:0 4px 12px rgba(30,68,48,.15);
  animation:pageNumPulse 3s ease-in-out infinite;
  z-index:100;
}
@keyframes pageNumPulse{
  0%,100%{transform:scale(1);opacity:.6;}
  50%{transform:scale(1.08);opacity:.9;}
}

/* ‚îÄ‚îÄ PAGE SELECTOR BAR ‚Äî snappier ‚îÄ‚îÄ */
.page-selector {
  display: flex; align-items: center; justify-content: center;
  gap: 8px; padding: 12px 16px;
  background: rgba(249,247,240,.88); backdrop-filter: blur(10px);
  border-bottom: 2px solid rgba(62,114,73,.12);
  flex-wrap: wrap; position: sticky; top: 0; z-index: 50;
}
.page-select-btn {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  padding: 8px 14px;
  background: rgba(255,255,255,.7); border: 2px solid rgba(62,114,73,.2);
  border-radius: 10px;
  font-family: 'Playfair Display', serif; font-size: 0.78rem;
  color: var(--forest-dark); cursor: pointer;
  transition: background .14s ease, border-color .14s ease, transform .14s cubic-bezier(.4,0,.2,1), box-shadow .14s ease;
  min-width: 88px; text-align: center; line-height: 1.3;
  will-change: transform;
}
.page-select-btn:hover {
  background: rgba(62,114,73,.12); border-color: rgba(62,114,73,.48);
  transform: translateY(-2px); box-shadow: 0 5px 12px rgba(30,68,48,.11);
}
.page-select-btn:active { transform: translateY(0) scale(.97); }
.page-select-btn.active {
  background: linear-gradient(135deg, #2d5a40, #3e7249);
  color: #fff; border-color: transparent;
  box-shadow: 0 6px 18px rgba(30,68,48,.32); transform: translateY(-2px);
}
.page-select-btn .ps-num { font-size: 1.05rem; font-weight: 700; }
.page-select-btn .ps-icon { font-size: 1rem; }
.page-select-btn .ps-title {
  font-size: 0.68rem; opacity: 0.85;
  max-width: 82px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.page-select-btn.active .ps-title { opacity: 1; }
.selector-divider { color: rgba(62,114,73,.3); font-size: 1rem; margin: 0 1px; }

/* ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ */
.section-title{
  font-family:'Playfair Display',serif;
  font-size:3.4rem; font-weight:700;
  text-align:center; margin-bottom:36px;
  position:relative; display:inline-block; width:100%;
  animation:writeIn 1.2s cubic-bezier(.4,0,.2,1), titleFloat 6s ease-in-out infinite;
  filter:drop-shadow(0 5px 15px rgba(30,68,48,.25));
  transform-style:preserve-3d;
}
.section-title .title-text{
  background:linear-gradient(118deg,var(--g7) 0%,var(--g5) 45%,var(--forest-dark) 100%);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
  animation:titleGlowPulse 3.5s ease-in-out infinite;
}
.section-title .title-icon{ display:inline-block; margin-right:10px; filter:drop-shadow(0 3px 8px rgba(30,68,48,.3)); }
@keyframes titleGlowPulse{
  0%,100%{filter:drop-shadow(0 5px 15px rgba(30,68,48,.25)) brightness(1);}
  50%{filter:drop-shadow(0 8px 25px rgba(62,114,73,.5)) brightness(1.15);}
}
@keyframes writeIn{
  from{opacity:0;transform:translateX(-60px) rotateY(-12deg);}
  to{opacity:1;transform:translateX(0) rotateY(0);}
}
.section-title::after{
  content:''; position:absolute; bottom:-14px; left:50%; transform:translateX(-50%);
  width:0; height:4px;
  background:linear-gradient(90deg,transparent,#2d5a40 20%,#3e7249 40%,#568c62 60%,#7aaa88 80%,transparent);
  animation:lineDraw 1.8s cubic-bezier(.4,0,.2,1) forwards, lineGlow 3.5s ease-in-out infinite;
  box-shadow:0 3px 20px rgba(30,68,48,.4); border-radius:3px;
}
@keyframes lineDraw{ from{width:0;opacity:0;} to{width:240px;opacity:1;} }
@keyframes lineGlow{
  0%,100%{box-shadow:0 3px 20px rgba(30,68,48,.4);filter:brightness(1);}
  50%{box-shadow:0 5px 35px rgba(62,114,73,.8), 0 0 15px rgba(122,170,136,.6);filter:brightness(1.3);}
}

.section-intro{
  text-align:center;max-width:820px;margin:0 auto 48px;
  font-size:1.28rem;line-height:1.95;color:var(--forest-green);font-style:italic;
  font-family:'Lora',serif;animation:fU .9s ease .4s both;font-weight:400;
}

/* ‚îÄ‚îÄ STORY CARDS ‚Äî smoother hover ‚îÄ‚îÄ */
.story-grid{display:grid;gap:36px;margin-top:48px;}
.story-card{
  display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:center;
  padding:32px;
  background:
    repeating-linear-gradient(90deg,transparent,transparent 2px,rgba(30,68,48,.04) 2px,rgba(30,68,48,.04) 4px),
    linear-gradient(135deg,rgba(249,247,240,.8),rgba(255,254,249,.6));
  border-radius:14px;
  transition:transform .22s cubic-bezier(.4,0,.2,1), box-shadow .22s ease, border-color .22s ease;
  border:2px solid rgba(30,68,48,.3);position:relative;overflow:hidden;
  box-shadow:0 6px 24px rgba(30,68,48,.1);
  transform-style:preserve-3d;
  will-change:transform;
}
.story-card::after{
  content:'';position:absolute;inset:0;
  background:radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(122,170,136,.1), transparent 50%);
  opacity:0;transition:opacity .25s ease;pointer-events:none;
}
.story-card:hover::after{opacity:1;}
.story-card:nth-child(even) .story-image{order:2;}
.story-card:nth-child(even) .story-text{order:1;}

.story-card:hover{
  transform:translateY(-7px) scale(1.012);
  box-shadow:0 18px 54px rgba(30,68,48,.16),0 6px 20px rgba(62,114,73,.1);
  border-color:rgba(62,114,73,.48);
}
.story-card:active{transform:translateY(-3px) scale(1.005);}

.story-image{
  position:relative;border-radius:8px;overflow:hidden;aspect-ratio:4/3;
  box-shadow:0 6px 24px rgba(30,68,48,.22),inset 0 0 0 7px rgba(250,246,240,.8),inset 0 0 0 9px rgba(30,68,48,.3);
  border:3px solid var(--beige);
  transition:box-shadow .22s ease;
}
.story-card:hover .story-image {
  box-shadow:0 10px 36px rgba(30,68,48,.32),inset 0 0 0 7px rgba(250,246,240,.9),inset 0 0 0 9px rgba(62,114,73,.4);
}
.story-image .stamp {
  position: absolute; top: 22px; right: 22px;
  width: 58px; height: 58px;
  background: linear-gradient(142deg, #d44e36, #c44536, #b83d2d);
  border: 3px dashed rgba(255,255,255,0.75); border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.8rem; transform: rotate(18deg);
  box-shadow: 0 4px 12px rgba(196,69,54,0.5); z-index: 5;
  animation: stampBounce 6s ease-in-out infinite;
  transition: transform .18s cubic-bezier(.4,0,.2,1);
}
.story-card:nth-child(2) .stamp {
  background: linear-gradient(142deg, #2d5a40, #3e7249, #305c3a);
  top: auto; bottom: 22px; left: 22px; right: auto; transform: rotate(-15deg);
}
.story-card:hover .stamp { transform: rotate(22deg) scale(1.1); }
.story-card:nth-child(2):hover .stamp { transform: rotate(-18deg) scale(1.1); }
@keyframes stampBounce {
  0%, 100% { transform: rotate(18deg) scale(1); }
  50% { transform: rotate(16deg) scale(1.08); }
}

.story-image img, .ci img, .pola img {
  width:100%;height:100%;object-fit:cover;
  transition:transform .5s cubic-bezier(.4,0,.2,1), filter .5s ease;
  filter:sepia(.05) contrast(1.05) brightness(1);
  cursor:pointer;
  background: linear-gradient(110deg, #e8dcc8 25%, #f0e8d8 50%, #e8dcc8 75%);
  background-size: 200% 100%;
  animation: shimmerLoad 1.5s ease-in-out infinite;
}
.story-image img.loaded, .ci img.loaded, .pola img.loaded {
  animation: none;
  background: none;
}
@keyframes shimmerLoad {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
.story-card:hover .story-image img{
  transform:scale(1.07) rotate(-.4deg);
  filter:sepia(.1) contrast(1.08) brightness(1.04);
}
.story-text{font-size:1.28rem;line-height:1.95;color:var(--ink-dark);font-family:'Lora',serif;font-weight:400;}
.story-text p{margin-bottom:14px;font-family:'Lora',serif;transition:transform .2s ease;}
.story-card:hover .story-text p{transform:translateX(3px);}
.story-text p:last-child{margin-bottom:0;}
.story-text .lead{font-size:1.18rem;font-style:italic;font-family:'Lora',serif;color:var(--ink-dark);margin-bottom:18px;line-height:1.95;font-weight:400;}

/* ‚îÄ‚îÄ POLAROID PHOTOS ‚îÄ‚îÄ */
.photo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:40px;margin:50px 0;}
.polaroid{
  background:#fff;padding:15px 15px 60px;
  box-shadow:0 10px 30px rgba(30,68,48,.28);
  transform:rotate(-3deg);
  transition:transform .25s cubic-bezier(.4,0,.2,1), box-shadow .25s ease;
  cursor:pointer; animation:photoAppear .9s ease-out; position:relative;
}
@keyframes photoAppear{from{opacity:0;transform:rotate(-15deg) scale(.7);}to{opacity:1;transform:rotate(-3deg) scale(1);}}
.polaroid:nth-child(even){transform:rotate(3deg);}
.polaroid:hover{
  transform:rotate(0) scale(1.07) translateY(-14px)!important;
  box-shadow:0 24px 55px rgba(30,68,48,.4),0 0 30px rgba(122,170,136,.16); z-index:10;
}
.polaroid img{width:100%;height:240px;object-fit:cover;display:block;filter:sepia(.05) contrast(1.05);transition:filter .4s;}
.polaroid:hover img{filter:sepia(.12) contrast(1.1);}
.polaroid-caption{
  margin-top:15px;text-align:center;font-family:'Dancing Script',cursive;
  font-size:1.15rem;color:var(--forest-green);
  position:absolute;bottom:15px;left:0;right:0;font-weight:600;
}
.polaroid::before{
  content:'';position:absolute;top:-10px;left:50%;transform:translateX(-50%);
  width:80px;height:24px;
  background:repeating-linear-gradient(45deg,rgba(30,68,48,.5),rgba(30,68,48,.5) 5px,rgba(255,255,255,.3) 5px,rgba(255,255,255,.3) 10px);
  border:1px solid rgba(30,68,48,.2);box-shadow:0 2px 6px rgba(0,0,0,.12);opacity:.8;
}
.img-text-overlay{
  position:absolute;top:0;left:0;right:0;bottom:60px;
  background:linear-gradient(to bottom,rgba(30,68,48,.88),rgba(30,68,48,.75));
  opacity:0;display:flex;align-items:center;justify-content:center;padding:18px;
  transition:opacity .3s ease;pointer-events:none;
}
.polaroid:hover .img-text-overlay{opacity:1;}
.img-text-content{
  color:#fff;text-align:center;font-family:'Lora',serif;font-size:1rem;
  line-height:1.65;font-style:italic;transform:translateY(16px);
  transition:transform .3s ease;
  text-shadow:0 2px 8px rgba(0,0,0,.3);
}
.polaroid:hover .img-text-content{transform:translateY(0);}

/* ‚îÄ‚îÄ JOURNEY TABS ‚Äî snappier ‚îÄ‚îÄ */
.journey-tabs{display:flex;gap:10px;justify-content:center;margin-bottom:28px;flex-wrap:wrap;}
.journey-tab{
  padding:12px 32px;background:rgba(255,255,255,.65);color:var(--ink-dark);
  border:2px solid rgba(62,114,73,.25);border-radius:50px;
  font-family:'Playfair Display',serif;font-weight:600;font-size:1rem;
  cursor:pointer;position:relative;overflow:hidden;
  backdrop-filter:blur(10px);
  box-shadow:0 2px 8px rgba(14,30,20,.06);
  transition:background .15s ease, border-color .15s ease, transform .15s cubic-bezier(.4,0,.2,1), box-shadow .15s ease;
  will-change:transform;
}
.journey-tab:focus { outline: 3px solid rgba(62,114,73,.6); outline-offset: 2px; }
.journey-tab::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(45deg,transparent,rgba(122,170,136,.20),transparent);
  transform:translateX(-100%);transition:transform .4s ease;
}
.journey-tab:hover::after{transform:translateX(100%);}
.journey-tab:hover{
  border-color:var(--g5); transform:translateY(-3px) scale(1.03);
  box-shadow:0 6px 16px rgba(14,30,20,.1);
}
.journey-tab:active{transform:translateY(-1px) scale(1.01);}
.journey-tab.active{
  background:linear-gradient(130deg,var(--g7),var(--g5));color:#fff;border-color:transparent;
  box-shadow:0 10px 28px rgba(30,68,48,.38),0 0 24px rgba(62,114,73,.2);
  animation:tabPl 3s ease-in-out infinite;
}
@keyframes tabPl{
  0%,100%{box-shadow:0 10px 28px rgba(30,68,48,.38),0 0 24px rgba(62,114,73,.2);}
  50%    {box-shadow:0 12px 36px rgba(30,68,48,.58),0 0 38px rgba(62,114,73,.38);}
}
.day-content{display:none;}
.day-content.active{display:block;animation:pageFade .55s cubic-bezier(.4,0,.2,1);}
@keyframes pageFade{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}

/* ‚îÄ‚îÄ ALBUM ‚îÄ‚îÄ */
.awrap{position:relative;margin-bottom:28px;}
.awrap::before, .awrap::after {
  content: '';
  position: absolute;
  top: 0; bottom: 34px; width: 48px;
  z-index: 20; pointer-events: none;
}
.awrap::before {
  left: 44px;
  background: linear-gradient(to right, rgba(249,247,240,.85), transparent);
}
.awrap::after {
  right: 44px;
  background: linear-gradient(to left, rgba(249,247,240,.85), transparent);
}
.atrack{
  display:flex;gap:22px;overflow-x:auto;
  padding:20px 56px 34px;
  scroll-snap-type:x mandatory;scrollbar-width:thin;
  scrollbar-color:rgba(62,114,73,.36) transparent;cursor:grab;
  scroll-behavior:smooth; -webkit-overflow-scrolling: touch;
}
.atrack:active{cursor:grabbing;}
.atrack::-webkit-scrollbar{height:5px;}
.atrack::-webkit-scrollbar-thumb{background:rgba(62,114,73,.34);border-radius:3px;}

.scroll-hint {
  text-align: center;
  font-family: 'Dancing Script', cursive;
  font-size: 0.85rem;
  color: rgba(62,114,73,.55);
  margin-top: -22px;
  margin-bottom: 10px;
  letter-spacing: 0.05em;
  animation: hintFade 2.5s ease-in-out infinite;
}
@keyframes hintFade { 0%,100%{opacity:.4;} 50%{opacity:.85;} }

.aarr{
  position:absolute;top:50%;transform:translateY(-58%);
  width:44px;height:44px;background:rgba(255,255,255,.95);
  border:2px solid rgba(62,114,73,.4);border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:1.2rem;color:var(--g7);cursor:pointer;
  z-index:30;
  box-shadow:0 4px 14px rgba(14,30,20,.18);
  backdrop-filter:blur(10px);user-select:none;
  transition:background .14s ease, border-color .14s ease, transform .14s cubic-bezier(.4,0,.2,1), box-shadow .14s ease;
  pointer-events:all;
  will-change:transform;
}
.aarr:focus { outline: 3px solid rgba(62,114,73,.6); outline-offset: 2px; }
.aarr:hover{
  background:rgba(62,114,73,.18);border-color:rgba(62,114,73,.7);
  transform:translateY(-58%) scale(1.1);
  box-shadow:0 6px 20px rgba(14,30,20,.25);
}
.aarr:active{transform:translateY(-58%) scale(1.02);}
.aarr.ap{left:4px;}.aarr.an{right:4px;}

.pola{
  flex:0 0 auto;background:#fff;padding:15px 15px 62px;
  box-shadow:0 8px 26px rgba(14,30,20,.13),0 0 0 .5px rgba(0,0,0,.05);
  border-radius:3px;cursor:pointer;position:relative;
  transition:transform .22s cubic-bezier(.4,0,.2,1), box-shadow .22s ease;
  scroll-snap-align:start;
  will-change:transform;
}
.pola::before{content:'';position:absolute;top:-9px;left:50%;
  transform:translateX(-50%) rotate(-1.5deg);
  width:70px;height:20px;background:rgba(174,206,186,.70);
  border:1px solid rgba(122,170,136,.48);border-radius:2px;box-shadow:0 1px 5px rgba(0,0,0,.07);}
.pola:nth-child(1){transform:rotate(-2.2deg);}
.pola:nth-child(2){transform:rotate( 1.9deg);}
.pola:nth-child(3){transform:rotate(-1.6deg);}
.pola:nth-child(4){transform:rotate( 2.4deg);}
.pola:hover{transform:rotate(0) scale(1.06) translateY(-10px)!important;
  box-shadow:0 18px 44px rgba(14,30,20,.22),0 0 0 3px rgba(62,114,73,.28);z-index:15;}
.pola:active{transform:scale(1.02) translateY(-4px)!important;}
.pola img{width:320px;height:260px;object-fit:cover;display:block;border-radius:2px;
  filter:saturate(1.05) contrast(1.03);transition:filter .4s ease;}
.pola.wide img{width:320px;height:260px;}
.pola:hover img{filter:saturate(1.18) contrast(1.06);}
.pcap{position:absolute;bottom:14px;left:0;right:0;text-align:center;
  font-family:'Dancing Script',cursive;font-size:1.05rem;color:var(--g7);padding:0 10px;font-weight:600;}

.dnote{
  padding:26px 34px;
  background:linear-gradient(135deg,rgba(174,206,186,.28),rgba(178,222,192,.20));
  border-left:4px solid var(--g5);border-radius:0 14px 14px 0;
  margin-bottom:16px;position:relative;overflow:hidden;
  transition:transform .2s ease, border-left-color .2s ease, box-shadow .2s ease;
}
.dnote::before{content:'‚ú¶';position:absolute;left:-10px;top:14px;
  font-size:1.1rem;color:var(--g5);animation:stTw 3.2s ease-in-out infinite;}
@keyframes stTw{0%,100%{opacity:.40;transform:scale(1) rotate(0);}50%{opacity:1;transform:scale(1.6) rotate(28deg);}}
.dnote:hover{transform:translateX(7px);border-left-color:var(--g6);
  box-shadow:0 6px 20px rgba(30,68,48,.12);}

.nlbl{font-family:'Dancing Script',cursive;font-size:1.2rem;color:var(--g6);margin-bottom:10px;display:block;font-weight:600;}
.ntxt{font-size:1.28rem;line-height:1.95;color:var(--ink-dark);font-family:'Lora',serif;font-weight:400;}

/* ‚îÄ‚îÄ MEANING CARDS ‚Äî elegant travel journal style ‚îÄ‚îÄ */
.meaning-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:28px;
  margin:48px 0;
}
.meaning-card{
  background:linear-gradient(160deg,#1e4430 0%,#1a3c28 60%,#162e1e 100%);
  padding:48px 30px 40px;
  border-radius:12px;
  text-align:center;
  border:1px solid rgba(201,169,97,.25);
  box-shadow:0 12px 40px rgba(0,0,0,.25), inset 0 1px 0 rgba(201,169,97,.15);
  transition:transform .2s cubic-bezier(.4,0,.2,1), box-shadow .2s ease, border-color .2s ease;
  display:flex;flex-direction:column;align-items:center;gap:18px;
  position:relative;overflow:hidden;
  will-change:transform;
  width:auto;min-height:auto;height:auto;
}
/* vi·ªÅn v√†ng m·∫£nh b√™n trong */
.meaning-card::before{
  content:'';
  position:absolute;inset:10px;
  border:1px solid rgba(201,169,97,.2);
  border-radius:8px;
  pointer-events:none;
}
/* √°nh s√°ng g√≥c tr√™n */
.meaning-card::after{
  content:'';
  position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(201,169,97,.5),transparent);
}
.meaning-card:hover{
  transform:translateY(-8px);
  box-shadow:0 24px 56px rgba(0,0,0,.32), inset 0 1px 0 rgba(201,169,97,.25);
  border-color:rgba(201,169,97,.5);
}
.meaning-card:active{transform:translateY(-3px);}
.meaning-icon{
  font-size:2.6rem;display:inline-block;
  filter:drop-shadow(0 4px 10px rgba(0,0,0,.3));
  animation:iconBounce 3.5s ease-in-out infinite;
  will-change:transform;
  position:relative;z-index:1;
}
.meaning-card:nth-child(2) .meaning-icon{animation-delay:.6s;}
.meaning-card:nth-child(3) .meaning-icon{animation-delay:1.2s;}
@keyframes iconBounce{0%,100%{transform:translateY(0);}50%{transform:translateY(-7px);}}
@keyframes cardFlip{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}
/* s·ªë th·ª© t·ª± ki·ªÉu t·∫°p ch√≠ */
.meaning-card-num{
  font-family:'Playfair Display',serif;
  font-size:.72rem;letter-spacing:.22em;
  color:rgba(201,169,97,.6);font-weight:600;
  position:relative;z-index:1;
}
.meaning-card h4{
  font-family:'Playfair Display',serif;font-size:1.18rem;
  color:#f0e8d0;font-weight:700;line-height:1.4;margin:0;
  position:relative;z-index:1;
}
.meaning-card h4::after{
  content:'';display:block;margin:10px auto 0;
  width:36px;height:1.5px;
  background:rgba(201,169,97,.55);
  border-radius:2px;
}
.meaning-card p{
  font-size:.95rem;line-height:1.82;
  color:rgba(174,206,186,.85);
  font-family:'Lora',serif;font-weight:400;margin:0;
  position:relative;z-index:1;
}

/* ‚îÄ‚îÄ QUOTE BOX ‚îÄ‚îÄ */
.quote-box{
  background:linear-gradient(135deg,rgba(249,247,240,.9),rgba(249,247,240,.7));
  border-left:5px solid #2d5a40;border-right:5px solid #3e7249;
  padding:36px 50px;
  margin:48px 0;
  position:relative;
  animation:quoteReveal 1.0s ease;
  border-radius:8px; box-shadow:0 6px 20px rgba(30,68,48,.12);
  transition:box-shadow .2s ease, transform .2s ease;
  overflow: visible;
}
.quote-box:hover{ box-shadow:0 10px 28px rgba(30,68,48,.16); transform:translateY(-3px); }
@keyframes quoteReveal{
  from{opacity:0;transform:scale(.94) translateY(24px);}
  to{opacity:1;transform:scale(1) translateY(0);}
}
.quote-box::before{
  content:'"';
  position:absolute;top:-18px;left:18px;
  font-size:6rem;line-height:1;
  font-family:'Playfair Display',serif;
  color:#3e7249;opacity:.22;
  pointer-events:none;
}
.quote-text{font-family:'Lora',serif;font-size:1.55rem;color:var(--forest-dark);line-height:1.85;text-align:center;position:relative;z-index:1;font-style:italic;font-weight:400;}

.callout{
  padding:22px 32px;margin:28px auto;max-width:840px;
  background:rgba(62,114,73,.16);border-left:5px solid #2d5a40;border-radius:0 12px 12px 0;
  font-family:'Lora',serif;font-size:1.3rem;line-height:1.9;
  color:var(--forest-dark);font-style:italic;font-weight:400;
  transition:transform .18s ease, box-shadow .18s ease, border-left-color .18s ease;
}
.callout:hover{ transform:translateX(7px); box-shadow:0 5px 18px rgba(30,68,48,.12); border-left-color:#3e7249; }

/* ‚îÄ‚îÄ FINAL PAGE LAYOUT ‚îÄ‚îÄ */
.cgrid{ display:flex;flex-direction:column;gap:60px;margin:42px 0; }
.ccard{
  display:flex;flex-direction:column;gap:32px;padding:40px 38px;
  background:
    radial-gradient(ellipse at 20% 30%, rgba(174,206,186,.15), transparent 50%),
    radial-gradient(ellipse at 80% 70%, rgba(122,170,136,.12), transparent 50%),
    linear-gradient(135deg,rgba(255,255,255,.65),rgba(249,247,240,.55));
  backdrop-filter:blur(12px);border-radius:20px;
  border:3px solid rgba(62,114,73,.2);
  box-shadow:0 10px 35px rgba(30,68,48,.13),inset 0 2px 8px rgba(255,255,255,.5);
  transition:transform .22s cubic-bezier(.4,0,.2,1), box-shadow .22s ease, border-color .22s ease;
  position:relative;overflow:hidden;align-items:center;
  will-change:transform;
}
.ccard::before{
  content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;
  background:radial-gradient(circle, rgba(122,170,136,.15), transparent 70%);
  opacity:0;transition:opacity .3s ease;pointer-events:none;
}
.ccard:hover::before{ opacity:1; }
.ccard::after{
  content:'';position:absolute;top:0;right:0;width:0;height:0;border-style:solid;
  border-width:0;border-color:transparent rgba(62,114,73,.3) transparent transparent;
  transition:border-width .3s ease, opacity .3s ease;opacity:0;
}
.ccard:hover::after{ border-width:0 60px 60px 0; opacity:1; }
.ccard:hover{
  transform:translateY(-8px) scale(1.01);
  box-shadow:0 26px 70px rgba(30,68,48,.2),0 10px 36px rgba(62,114,73,.16),inset 0 2px 12px rgba(255,255,255,.7);
  border-color:rgba(62,114,73,.36);
}
.ccard:active{transform:translateY(-3px) scale(1.004);}
.ci{
  border-radius:14px;overflow:hidden;aspect-ratio:3/2;
  box-shadow:0 10px 30px rgba(30,68,48,.14),0 0 0 9px rgba(255,255,255,.8),0 0 0 11px rgba(62,114,73,.22);
  border:3px solid rgba(62,114,73,.38);background:var(--beige);
  max-height:400px;width:80%;
  transition:box-shadow .22s ease, transform .22s ease;
  position:relative;
}
.ci img{
  width:100%;height:100%;object-fit:cover;cursor:pointer;
  transition:transform .5s cubic-bezier(.4,0,.2,1), filter .5s ease;
  filter:saturate(1.05) contrast(1.05);
}
.ccard:hover .ci{
  box-shadow:0 14px 42px rgba(30,68,48,.2),0 0 0 9px rgba(255,255,255,.9),0 0 0 11px rgba(62,114,73,.3),0 0 22px rgba(122,170,136,.22);
  transform:scale(1.02);
}
.ccard:hover .ci img{ transform:scale(1.05) rotate(-.4deg); filter:saturate(1.15) contrast(1.06); }
.ct{ width:100%;max-width:820px; }
.ct p{
  font-size:1.28rem;line-height:2.1;color:var(--ink-dark);
  margin-bottom:18px;font-family:'Lora',serif;font-weight:400;
  width:100%;text-align:left;transition:transform .18s ease, color .18s ease;
}
.ct p:last-child{ margin-bottom:0; }
.ccard:hover .ct p{ transform:translateX(4px); color:var(--forest-dark); }

/* ‚îÄ‚îÄ PAGE NAV ‚Äî snappier ‚îÄ‚îÄ */
.page-nav{display:flex;justify-content:space-between;align-items:center;margin-top:56px;padding-top:36px;border-top:2px solid rgba(30,68,48,.28);position:relative;z-index:100;}
.nav-btn{
  padding:11px 28px;background:linear-gradient(135deg,#2d5a40,#3e7249);
  color:#fff;font-weight:700;border-radius:50px;
  box-shadow:0 5px 16px rgba(30,68,48,.45);
  transition:transform .15s cubic-bezier(.4,0,.2,1), box-shadow .15s ease;
  font-family:'Playfair Display',serif;font-size:0.9rem;
  border:2px solid rgba(62,114,73,.6);cursor:pointer;
  position:relative;overflow:hidden;z-index:100;
  will-change:transform;
}
.nav-btn:focus { outline: 3px solid rgba(201,169,97,.8); outline-offset: 4px; }
.nav-btn::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;
  background:radial-gradient(circle,rgba(255,255,255,.55),transparent 70%);
  border-radius:50%;transform:translate(-50%,-50%);transition:width .5s,height .5s;}
.nav-btn:hover::before{width:360px;height:360px;}
.nav-btn:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(30,68,48,.56);}
.nav-btn:active{transform:translateY(0);}
.nav-btn.disabled{opacity:.3;pointer-events:none;}
.nav-btn.cover-btn { background: linear-gradient(135deg, #2d5a40, #1a3c28); border-color: rgba(201,169,97,.4); }

.prog{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:16px;}
.pdot{width:8px;height:8px;border-radius:50%;cursor:pointer;background:rgba(30,68,48,.22);border:1.5px solid rgba(30,68,48,.30);
  transition:all .18s cubic-bezier(.4,0,.2,1);}
.pdot:focus { outline: 2px solid rgba(62,114,73,.6); outline-offset: 3px; }
.pdot.on{width:26px;border-radius:5px;background:linear-gradient(90deg,#2d5a40,#3e7249);border-color:transparent;box-shadow:0 2px 8px rgba(30,68,48,.28);}
.pdot:hover:not(.on){background:rgba(30,68,48,.40);transform:scale(1.3);}

.rdiv{display:flex;align-items:center;gap:15px;margin:36px 0;opacity:.28;}
.rdiv::before,.rdiv::after{content:'';flex:1;height:2px;background:linear-gradient(90deg,transparent,#2d5a40,transparent);}
.sig{text-align:center;font-family:'Dancing Script',cursive;font-size:2.4rem;color:var(--forest-green);opacity:.7;margin:6px 0 36px;}
.dclouds{text-align:center;font-size:1.3rem;letter-spacing:18px;opacity:.26;margin:12px 0;animation:dcWv 8s ease-in-out infinite;}
@keyframes dcWv{0%,100%{transform:translateY(0);opacity:.24;}50%{transform:translateY(-6px);opacity:.44;}}

/* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
.image-modal{
  position:fixed;inset:0;background:rgba(30,68,48,.96);backdrop-filter:blur(15px);
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity .3s ease;z-index:1000;
}
.image-modal.active{opacity:1;pointer-events:auto;}
.image-modal img{
  max-width:92%;max-height:92%;
  box-shadow:0 35px 90px rgba(0,0,0,.8),0 0 0 16px #fff,0 0 0 18px rgba(62,114,73,.6);
  animation:modalZoom .45s cubic-bezier(.4,0,.2,1);border-radius:8px;
}
@keyframes modalZoom{from{opacity:0;transform:scale(.65) rotate(-6deg);}to{opacity:1;transform:scale(1) rotate(0);}}
.modal-close{
  position:absolute;top:30px;right:30px;width:48px;height:48px;
  background:rgba(255,255,255,.22);border:2px solid rgba(62,114,73,.7);
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-size:1.7rem;color:#fff;cursor:pointer;
  transition:background .15s ease, transform .15s ease;
  backdrop-filter:blur(10px);z-index:1001;
}
.modal-close:focus { outline: 3px solid rgba(201,169,97,.8); outline-offset: 4px; }
.modal-close:hover{background:rgba(62,114,73,.6);transform:rotate(90deg) scale(1.1);}
.modal-close:active{transform:rotate(90deg) scale(.95);}

.modal-nav {
  position: absolute; top: 50%; transform: translateY(-50%);
  width: 48px; height: 48px;
  background: rgba(255,255,255,.18); border: 2px solid rgba(122,170,136,.5);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-size: 1.5rem; color: #fff; cursor: pointer;
  transition: background .15s ease, transform .15s ease;
  backdrop-filter: blur(8px); z-index: 1001;
}
.modal-nav:hover { background: rgba(62,114,73,.5); transform: translateY(-50%) scale(1.08); }
.modal-nav:active { transform: translateY(-50%) scale(.95); }
.modal-nav.prev { left: 20px; }
.modal-nav.next { right: 80px; }
.modal-caption {
  position: absolute; bottom: 24px; left: 50%; transform: translateX(-50%);
  font-family: 'Dancing Script', cursive; font-size: 1.1rem;
  color: rgba(255,255,255,.8); text-align: center;
  background: rgba(0,0,0,.3); padding: 6px 20px; border-radius: 20px;
  backdrop-filter: blur(8px);
}

/* ‚îÄ‚îÄ SCROLL-IN ANIMATION ‚îÄ‚îÄ */
.will-animate {
  opacity: 0;
  transition: opacity .5s ease;
}
.will-animate.in-view {
  opacity: 1;
}

/* ‚îÄ‚îÄ SCROLL TO TOP ‚îÄ‚îÄ */
.scroll-top{
  position:fixed;bottom:38px;right:38px;width:55px;height:55px;
  background:linear-gradient(135deg,#2d5a40,#3e7249);
  border:2px solid #fff;border-radius:50%;display:flex;align-items:center;justify-content:center;
  font-size:1.7rem;cursor:pointer;box-shadow:0 10px 30px rgba(30,68,48,.55);
  transition:opacity .2s ease, transform .18s cubic-bezier(.4,0,.2,1), box-shadow .18s ease;
  z-index:100;opacity:0;pointer-events:none;color:#fff;
  will-change:transform;
}
.scroll-top:focus { outline: 3px solid rgba(201,169,97,.8); outline-offset: 4px; }
.scroll-top.visible{opacity:1;pointer-events:auto;animation:scrollTopBounce 2.2s ease-in-out infinite;}
@keyframes scrollTopBounce{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-6px);}
}
.scroll-top:hover{transform:translateY(-6px) scale(1.08)!important;box-shadow:0 14px 38px rgba(30,68,48,.7);}
.scroll-top:active{transform:translateY(-2px) scale(1.02)!important;}

.loading-spinner{
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  width:80px;height:80px;border:5px solid rgba(62,114,73,.2);border-top-color:#2d5a40;
  border-radius:50%;animation:spinnerRotate 1s linear infinite;z-index:10000;display:none;
}
.loading-spinner.active{display:block;}
.loading-spinner::after{content:'üåø';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.8rem;}
@keyframes spinnerRotate{to{transform:translate(-50%,-50%) rotate(360deg);}}

/* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
@media(max-width:1100px){
  .meaning-grid{gap:20px;}
  .meaning-card{padding:36px 22px 32px;}
  .cgrid{gap:50px;}
}
@media(max-width:900px){
  .page{padding:60px 55px 100px;}
  .section-title{font-size:2.4rem;}
  .section-intro{font-size:1.1rem;}
  .story-text{font-size:1rem;}
  .meaning-grid{grid-template-columns:1fr;max-width:420px;margin-left:auto;margin-right:auto;}
  .meaning-card{padding:32px 26px;}
  .ntxt{font-size:1rem;}
  .cgrid{gap:44px;}
  .ct p{font-size:1.1rem;}
  .quote-text{font-size:1.45rem;}
}
@media(max-width:768px){
  body{padding:22px 10px;}
  .book-cover{padding:44px 30px;border:5px solid rgba(30,68,48,.4);}
  .cover-title{font-size:3.2rem;}
  .cover-subtitle{font-size:1.6rem;}
  .cover-quote{font-size:0.95rem;}
  .page{padding:50px 24px 90px;border-left:30px solid rgba(30,68,48,.08);}
  .section-title{font-size:2rem;}
  .section-intro{font-size:1rem;}
  .story-card{grid-template-columns:1fr!important;gap:26px;}
  .story-card:nth-child(even) .story-image{order:0;}
  .story-card:hover{transform:translateY(-4px) scale(1.006);}
  .story-text{font-size:1rem;}
  .journey-tabs{flex-direction:column;}
  .journey-tab{width:100%;}
  .meaning-grid{grid-template-columns:1fr;max-width:100%;}
  .meaning-card{padding:30px 24px;}
  .cgrid{gap:34px;}
  .ci{width:92%;}
  .ct p{font-size:1.05rem;}
  .ntxt{font-size:1rem;}
  .quote-text{font-size:1.3rem;}
  .breadcrumb{
    top:auto; bottom:20px; left:50%; right:auto;
    transform:translateX(-50%);
    font-size:0.72rem; padding:5px 14px;
    max-width:calc(100vw - 40px);
  }
  .aarr{display:none;}
  .page-select-btn .ps-title { display: none; }
  .page-selector { gap: 5px; padding: 10px 8px; }
  .page-select-btn { min-width: 55px; padding: 7px 10px; }
  .home-btn { font-size: 0.76rem; padding: 7px 12px; }
  .awrap::before, .awrap::after { display: none; }
  .scroll-hint { display: block; }
}
@media(max-width:480px){
  .page{padding:38px 14px 80px;}
  .section-title{font-size:1.75rem;}
  .section-intro{font-size:0.92rem;}
  .story-text{font-size:0.92rem;}
  .ntxt{font-size:0.92rem;}
  .ct p{font-size:0.94rem;line-height:1.9;}
  .quote-box{padding:28px 18px;}
  .quote-text{font-size:1.15rem;line-height:1.7;}
  .callout{font-size:0.98rem; padding:18px 20px;}
  .sig{font-size:2rem;}
  .cgrid{gap:28px;}
  .cover-title{font-size:2.4rem;}
  .cover-subtitle{font-size:1.4rem;}
  .cover-quote{font-size:0.88rem;}
  .selector-divider { display: none; }
  .open-book-btn{font-size:0.92rem;padding:12px 32px;}
  .page-number{font-size:1.1rem;bottom:18px;right:20px;}
  .quote-box::before{font-size:4rem;top:-12px;left:10px;}
}

/* prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  *,*::before,*::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  .nav-btn, .open-book-btn, .meaning-card, .story-card, .pola, .ccard {
    transition: opacity .15s, box-shadow .15s !important;
  }
}
</style>
</head>
<body>

<div class="sr-announce" aria-live="polite" aria-atomic="true" id="srAnnounce"></div>

<div class="progress-bar-container" id="progressBarContainer">
  <div class="progress-bar" id="progressBar"></div>
</div>

<a href="index.html" class="home-btn" aria-label="Quay v·ªÅ trang ch·ªß">
  üè† <span>Trang Ch·ªß</span>
</a>

<div class="breadcrumb" id="breadcrumb" role="navigation" aria-label="V·ªã tr√≠ hi·ªán t·∫°i">
  <span class="breadcrumb-icon" aria-hidden="true">üìñ</span>
  <span id="breadcrumbText">B√¨a s√°ch</span>
</div>

<div class="loading-spinner" id="loadingSpinner" role="status" aria-label="ƒêang t·∫£i..."></div>

<div class="book-container" id="bookContainer">

  <!-- ‚ïê‚ïê COVER ‚ïê‚ïê -->
  <div class="book-cover" id="bookCover">
    <div class="bookmark" aria-hidden="true"></div>
    <div class="ff-wrap" id="ffWrap" aria-hidden="true"></div>
    <div class="cover-content">
      <div class="cover-badge" aria-label="M·ªëc k·ª∑ ni·ªám th·ª© 5 tr√™n 6">‚ú¶ &nbsp;M·ªëc K·ª∑ Ni·ªám Th·ª© 5 / 6&nbsp; ‚ú¶</div>
      <div class="cover-icon-wrap" aria-hidden="true">
        <div class="cover-icon">üå≤</div>
      </div>
      <h1 class="cover-title">NH·∫¨T K√ù ƒê√Ä L·∫†T</h1>
      <h2 class="cover-subtitle">D·∫•u ·∫•n kh√¥ng phai trong mi·ªÅn k√Ω ·ª©c l·ªõp 11L</h2>
      <p class="cover-quote">
        C√≥ nh·ªØng mi·ªÅn ƒë·∫•t ta ch·ªâ gh√© qua m·ªôt l·∫ßn trong ƒë·ªùi,<br>
        nh∆∞ng l·∫°i ·ªü l·∫°i r·∫•t l√¢u trong k√Ω ·ª©c...<br>
        ƒê√† L·∫°t c·ªßa l·ªõp 11L l√† m·ªôt mi·ªÅn nh∆∞ th·∫ø.
      </p>
      <button class="open-book-btn" id="openBookBtn" aria-label="M·ªü nh·∫≠t k√Ω ƒê√† L·∫°t">
        <span>üçÉ &nbsp;M·ªü Nh·∫≠t K√Ω&nbsp; üçÉ</span>
      </button>
    </div>
  </div>

  <!-- ‚ïê‚ïê PAGES ‚ïê‚ïê -->
  <div class="book-pages" id="bookPages" style="display:none;">

    <nav class="page-selector" role="navigation" aria-label="Ch·ªçn trang">
      <button class="page-select-btn active" data-page="1" aria-label="Trang 1: Mi·ªÅn K√Ω ·ª®c M·ªü Ra" aria-current="page">
        <span class="ps-icon" aria-hidden="true">üåø</span>
        <span class="ps-num">01</span>
        <span class="ps-title">K√Ω ·ª®c M·ªü Ra</span>
      </button>
      <span class="selector-divider" aria-hidden="true">‚Ä∫</span>
      <button class="page-select-btn" data-page="2" aria-label="Trang 2: √ù Nghƒ©a Chuy·∫øn ƒêi">
        <span class="ps-icon" aria-hidden="true">üìö</span>
        <span class="ps-num">02</span>
        <span class="ps-title">√ù Nghƒ©a</span>
      </button>
      <span class="selector-divider" aria-hidden="true">‚Ä∫</span>
      <button class="page-select-btn" data-page="3" aria-label="Trang 3: H√†nh Tr√¨nh Ba Ng√†y">
        <span class="ps-icon" aria-hidden="true">üìç</span>
        <span class="ps-num">03</span>
        <span class="ps-title">H√†nh Tr√¨nh</span>
      </button>
      <span class="selector-divider" aria-hidden="true">‚Ä∫</span>
      <button class="page-select-btn" data-page="4" aria-label="Trang 4: Mi·ªÅn K√Ω ·ª®c">
        <span class="ps-icon" aria-hidden="true">üå∏</span>
        <span class="ps-num">04</span>
        <span class="ps-title">Mi·ªÅn K√Ω ·ª®c</span>
      </button>
    </nav>

    <div class="prog" style="padding-top:20px;" role="navigation" aria-label="ƒêi·ªÅu h∆∞·ªõng trang">
      <button class="pdot on" data-p="1" aria-label="Trang 1" aria-current="true"></button>
      <button class="pdot" data-p="2" aria-label="Trang 2"></button>
      <button class="pdot" data-p="3" aria-label="Trang 3"></button>
      <button class="pdot" data-p="4" aria-label="Trang 4"></button>
    </div>

    <!-- ‚ïê‚ïê PAGE 1 ‚ïê‚ïê -->
    <div class="page" id="page1" role="main">
      <div class="leaf-layer" id="lf1" aria-hidden="true"></div>
      <div class="page-content">
        <div class="dclouds" aria-hidden="true">‚òÅÔ∏è &nbsp;&nbsp; ‚òÅÔ∏è &nbsp;&nbsp;&nbsp;&nbsp; ‚òÅÔ∏è</div>
        <h3 class="section-title">
          <span class="title-icon" aria-hidden="true">üåø</span>
          <span class="title-text">Mi·ªÅn K√Ω ·ª®c M·ªü Ra</span>
        </h3>
        <p class="section-intro">
          C√≥ nh·ªØng mi·ªÅn ƒë·∫•t ta ch·ªâ gh√© qua m·ªôt l·∫ßn trong ƒë·ªùi, nh∆∞ng l·∫°i ·ªü l·∫°i r·∫•t l√¢u trong k√Ω ·ª©c.<br>
          ƒê√† L·∫°t c·ªßa l·ªõp 11L l√† m·ªôt mi·ªÅn nh∆∞ th·∫ø.
        </p>
        
        <div class="story-grid">
          <article class="story-card">
            <div class="story-image">
              <div class="stamp" aria-hidden="true">üèîÔ∏è</div>
              <img src="images/tongthe.jpg" alt="To√†n c·∫£nh th√†nh ph·ªë ƒê√† L·∫°t v·ªõi r·ª´ng th√¥ng xanh m√°t" loading="lazy">
            </div>
            <div class="story-text">
              <p>ƒê√≥ l√† n∆°i s∆∞∆°ng s·ªõm giƒÉng m·ªù tr√™n nh·ªØng tri·ªÅn ƒë·ªìi, n∆°i r·ª´ng th√¥ng th√¨ th·∫ßm trong gi√≥, n∆°i nh·ªãp s·ªëng ch·∫≠m r√£i m·ªü ra nh·ªØng kho·∫£ng l·∫∑ng hi·∫øm hoi gi·ªØa nh·ªØng ng√†y h·ªçc t·∫≠p v·ªôi v√£.</p>
            </div>
          </article>
          
          <article class="story-card">
            <div class="story-image">
              <div class="stamp" aria-hidden="true">üë•</div>
              <img src="images/tapthe.jpg" alt="T·∫≠p th·ªÉ h·ªçc sinh l·ªõp 11L t·∫°i ƒê√† L·∫°t" loading="lazy">
            </div>
            <div class="story-text" style="max-width:480px;">
              <p>ƒê√† L·∫°t kh√¥ng ch·ªâ hi·ªán l√™n trong v·∫ª ƒë·∫πp th∆° m·ªông c·ªßa ph·ªë n√∫i, m√† c√≤n l√† kh√¥ng gian c·ªßa tri th·ª©c, c·ªßa l·ªãch s·ª≠, c·ªßa nh·ªØng gi√° tr·ªã b·ªÅn b·ªâ ƒë∆∞·ª£c b·ªìi ƒë·∫Øp qua nƒÉm th√°ng.</p>
              <p>V√† trong m·ªôt kho·∫£nh kh·∫Øc r·∫•t ƒë·∫πp c·ªßa tu·ªïi h·ªçc tr√≤, l·ªõp 11L ƒë√£ ƒë·∫∑t d·∫•u ch√¢n m√¨nh l√™n mi·ªÅn ƒë·∫•t ·∫•y ‚Äì b·∫±ng t·∫•t c·∫£ s·ª± h√°o h·ª©c, trong veo v√† kh√°t khao kh√°m ph√°.</p>
            </div>
          </article>
        </div>
      </div>
      <div class="page-number" aria-label="Trang 1 tr√™n 4">~ Trang 1 ~</div>
      <nav class="page-nav" aria-label="ƒêi·ªÅu h∆∞·ªõng gi·ªØa c√°c trang">
        <button class="nav-btn cover-btn" onclick="closePage()" aria-label="Quay v·ªÅ b√¨a s√°ch">üå≤ V·ªÅ B√¨a S√°ch</button>
        <button class="nav-btn" onclick="turnPage(2)" aria-label="ƒê·∫øn trang 2">Trang sau ‚Üí</button>
      </nav>
    </div>

    <!-- ‚ïê‚ïê PAGE 2 ‚ïê‚ïê -->
    <div class="page" id="page2" style="display:none;" role="main">
      <div class="page-content">
        <h3 class="section-title">
          <span class="title-icon" aria-hidden="true">üå±</span>
          <span class="title-text">√ù Nghƒ©a C·ªßa M·ªôt Chuy·∫øn ƒêi</span>
        </h3>
        <p class="section-intro">Gi·ªØa nh·ªØng ti·∫øt h·ªçc n·ªëi ti·∫øp nhau, gi·ªØa nh·ªØng b√†i ki·ªÉm tra v√† √°p l·ª±c v√¥ h√¨nh, chuy·∫øn ƒëi ƒê√† L·∫°t ƒë·∫øn nh∆∞ m·ªôt kho·∫£ng th·ªü d·ªãu d√†ng.</p>

        <div class="callout">
          M·ªói ƒëi·ªÉm ƒë·∫øn ƒë·ªÅu l√† m·ªôt trang s√°ch s·ªëng ƒë·ªông.<br>
          M·ªói b∆∞·ªõc ch√¢n ƒë·ªÅu m·ªü ra m·ªôt b√†i h·ªçc kh√¥ng n·∫±m trong gi√°o tr√¨nh.
        </div>

        <div class="meaning-grid">
          <article class="meaning-card">
            <span class="meaning-card-num">01</span>
            <div class="meaning-icon" aria-hidden="true">üìö</div>
            <h4>Tri th·ª©c s·ªëng ƒë·ªông</h4>
            <p>T·ª´ thi√™n nhi√™n xanh m√°t ƒë·∫øn nh·ªØng c√¥ng tr√¨nh l·ªãch s·ª≠, tri th·ª©c kh√¥ng ch·ªâ n·∫±m trong trang v·ªü m√† c√≤n hi·ªán di·ªán trong t·ª´ng nh·ªãp s·ªëng c·ªßa ƒë·∫•t n∆∞·ªõc.</p>
          </article>
          <article class="meaning-card">
            <span class="meaning-card-num">02</span>
            <div class="meaning-icon" aria-hidden="true">üå≤</div>
            <h4>Kh√¥ng gian thi√™n nhi√™n</h4>
            <p>T·ª´ kh√¥ng gian h·ªçc thu·∫≠t ƒë·∫øn nh·ªØng g√≥c ph·ªë b√¨nh y√™n, t·∫•t c·∫£ gi√∫p ch√∫ng t√¥i hi·ªÉu r√µ h∆°n v·ªÅ nh·ªØng gi√° tr·ªã l·ªãch s·ª≠ v√† vƒÉn h√≥a c·ªßa cao nguy√™n L√¢m Vi√™n.</p>
          </article>
          <article class="meaning-card">
            <span class="meaning-card-num">03</span>
            <div class="meaning-icon" aria-hidden="true">üí´</div>
            <h4>G·∫Øn k·∫øt t√¨nh b·∫°n</h4>
            <p>Qua nh·ªØng b·ªØa ƒÉn gi·∫£n d·ªã, nh·ªØng kho·∫£nh kh·∫Øc c∆∞·ªùi ƒë√πa v√¥ t∆∞, ch√∫ng t√¥i h·ªçc c√°ch l·∫Øng nghe, th·∫•u hi·ªÉu v√† tr√¢n tr·ªçng nhau h∆°n.</p>
          </article>
        </div>

        <blockquote class="quote-box">
          <p class="quote-text">
            Quan tr·ªçng h∆°n c·∫£, chuy·∫øn ƒëi l√† s·ª£i d√¢y v√¥ h√¨nh k·∫øt n·ªëi nh·ªØng t√¢m h·ªìn tu·ªïi m∆∞·ªùi b·∫£y...
          </p>
        </blockquote>
      </div>
      <div class="page-number" aria-label="Trang 2 tr√™n 4">~ Trang 2 ~</div>
      <nav class="page-nav" aria-label="ƒêi·ªÅu h∆∞·ªõng gi·ªØa c√°c trang">
        <button class="nav-btn" onclick="turnPage(1)" aria-label="V·ªÅ trang 1">‚Üê Trang tr∆∞·ªõc</button>
        <button class="nav-btn" onclick="turnPage(3)" aria-label="ƒê·∫øn trang 3">Trang sau ‚Üí</button>
      </nav>
    </div>

    <!-- ‚ïê‚ïê PAGE 3 ‚ïê‚ïê -->
    <div class="page" id="page3" style="display:none;" role="main">
      <div class="leaf-layer" id="lf3" aria-hidden="true"></div>
      <div class="page-content">
        <h3 class="section-title">
          <span class="title-icon" aria-hidden="true">üìç</span>
          <span class="title-text">H√†nh Tr√¨nh Ba Ng√†y ‚Äì M·ªôt Mi·ªÅn K√Ω ·ª®c</span>
        </h3>
        
        <div class="journey-tabs" role="tablist" aria-label="Ch·ªçn ng√†y trong h√†nh tr√¨nh">
          <button class="journey-tab active" data-day="day1" id="tab-day1" role="tab" aria-selected="true" aria-controls="day1">üóìÔ∏è Ng√†y 01</button>
          <button class="journey-tab" data-day="day2" id="tab-day2" role="tab" aria-selected="false" aria-controls="day2">üóìÔ∏è Ng√†y 02</button>
          <button class="journey-tab" data-day="day3" id="tab-day3" role="tab" aria-selected="false" aria-controls="day3">üóìÔ∏è Ng√†y 03</button>
        </div>
        
        <div id="day1" class="day-content active" role="tabpanel" aria-labelledby="tab-day1">
          <div class="awrap">
            <button class="aarr ap" data-album="album1" aria-label="Cu·ªôn sang tr√°i">‚Äπ</button>
            <div class="atrack" id="album1" role="region" aria-label="Album ·∫£nh ng√†y 1">
              <figure class="pola wide">
                <img src="images/lenxe.jpg" alt="H·ªçc sinh l·ªõp 11L l√™n xe kh·ªüi h√†nh t·ª´ B√¨nh D∆∞∆°ng" loading="lazy">
                <figcaption class="pcap">üöå Kh·ªüi h√†nh t·ª´ B√¨nh D∆∞∆°ng</figcaption>
              </figure>
              <figure class="pola">
                <img src="images/truongdh.jpg" alt="Tr∆∞·ªùng ƒê·∫°i h·ªçc ƒê√† L·∫°t" loading="lazy">
                <figcaption class="pcap">üèõÔ∏è ƒêH ƒê√† L·∫°t</figcaption>
              </figure>
              <figure class="pola">
                <img src="images/khachsan.jpg" alt="Kh√°ch s·∫°n n∆°i l∆∞u tr√∫" loading="lazy">
                <figcaption class="pcap">üè® Nh·∫≠n ph√≤ng</figcaption>
              </figure>
            </div>
            <button class="aarr an" data-album="album1" aria-label="Cu·ªôn sang ph·∫£i">‚Ä∫</button>
          </div>
          <p class="scroll-hint" aria-hidden="true">‚Üê vu·ªët ƒë·ªÉ xem th√™m ·∫£nh ‚Üí</p>
          <aside class="dnote">
            <span class="nlbl">‚òÄÔ∏è Ng√†y ƒë·∫ßu ti√™n ‚Äî Kh·ªüi h√†nh</span>
            <p class="ntxt">Sau ch·∫∑ng ƒë∆∞·ªùng d√†i t·ª´ B√¨nh D∆∞∆°ng, l·ªõp 11L b·∫Øt ƒë·∫ßu h√†nh tr√¨nh trong s·ª± h√°o h·ª©c v√† mong ch·ªù. ƒêi·ªÉm d·ª´ng ch√¢n ƒë·∫ßu ti√™n l√† Tr∆∞·ªùng ƒê·∫°i h·ªçc ƒê√† L·∫°t ‚Äì n∆°i tri th·ª©c v√† ki·∫øn tr√∫c giao h√≤a, gieo v√†o l√≤ng ch√∫ng t√¥i ni·ªÅm k√≠nh tr·ªçng ƒë·ªëi v·ªõi con ƒë∆∞·ªùng h·ªçc v·∫•n.</p>
          </aside>
        </div>
        
        <div id="day2" class="day-content" role="tabpanel" aria-labelledby="tab-day2">
          <div class="awrap">
            <button class="aarr ap" data-album="album2" aria-label="Cu·ªôn sang tr√°i">‚Äπ</button>
            <div class="atrack" id="album2" role="region" aria-label="Album ·∫£nh ng√†y 2">
              <figure class="pola wide">
                <img src="images/caugo.jpg" alt="C·∫ßu G·ªó v·ªõi bi·ªÉn m√¢y tr·∫Øng x√≥a" loading="lazy">
                <figcaption class="pcap">‚òÅÔ∏è Bi·ªÉn m√¢y C·∫ßu G·ªó</figcaption>
              </figure>
              <figure class="pola">
                <img src="images/puppy.jpg" alt="Puppy Farm ƒê√† L·∫°t" loading="lazy">
                <figcaption class="pcap">üêï Puppy Farm</figcaption>
              </figure>
              <figure class="pola">
                <img src="images/quangtruong.jpg" alt="Qu·∫£ng tr∆∞·ªùng L√¢m Vi√™n" loading="lazy">
                <figcaption class="pcap">üèôÔ∏è L√¢m Vi√™n</figcaption>
              </figure>
            </div>
            <button class="aarr an" data-album="album2" aria-label="Cu·ªôn sang ph·∫£i">‚Ä∫</button>
          </div>
          <p class="scroll-hint" aria-hidden="true">‚Üê vu·ªët ƒë·ªÉ xem th√™m ·∫£nh ‚Üí</p>
          <aside class="dnote">
            <span class="nlbl">‚òÅÔ∏è Ng√†y th·ª© hai ‚Äî Tr·∫£i nghi·ªám</span>
            <p class="ntxt">Bu·ªïi s√°ng, C·∫ßu G·ªó ƒë√≥n ch√∫ng t√¥i b·∫±ng bi·ªÉn m√¢y tr·∫Øng x√≥a, mang ƒë·∫øn c·∫£m gi√°c nh∆∞ ch·∫°m tay v√†o b·∫ßu tr·ªùi. T·∫°i Puppy Farm, ti·∫øng c∆∞·ªùi h√≤a c√πng √°nh n·∫Øng v√† nh·ªØng ch√∫ c√∫n nh·ªè, ƒë∆∞a ch√∫ng t√¥i tr·ªü v·ªÅ v·ªõi s·ª± h·ªìn nhi√™n thu·∫ßn khi·∫øt.</p>
          </aside>
        </div>
        
        <div id="day3" class="day-content" role="tabpanel" aria-labelledby="tab-day3">
          <div class="awrap">
            <button class="aarr ap" data-album="album3" aria-label="Cu·ªôn sang tr√°i">‚Äπ</button>
            <div class="atrack" id="album3" role="region" aria-label="Album ·∫£nh ng√†y 3">
              <figure class="pola">
                <img src="images/ansang.jpg" alt="B·ªØa ƒÉn s√°ng cu·ªëi c√πng t·∫°i ƒê√† L·∫°t" loading="lazy">
                <figcaption class="pcap">‚òï B·ªØa s√°ng cu·ªëi</figcaption>
              </figure>
              <figure class="pola wide">
                <img src="images/dinh3.jpg" alt="Dinh III B·∫£o ƒê·∫°i" loading="lazy">
                <figcaption class="pcap">üèØ Dinh III</figcaption>
              </figure>
              <figure class="pola">
                <img src="images/roidal.jpg" alt="Chia tay ƒê√† L·∫°t" loading="lazy">
                <figcaption class="pcap">üëã T·∫°m bi·ªát!</figcaption>
              </figure>
            </div>
            <button class="aarr an" data-album="album3" aria-label="Cu·ªôn sang ph·∫£i">‚Ä∫</button>
          </div>
          <p class="scroll-hint" aria-hidden="true">‚Üê vu·ªët ƒë·ªÉ xem th√™m ·∫£nh ‚Üí</p>
          <aside class="dnote">
            <span class="nlbl">üåÖ Ng√†y cu·ªëi ‚Äî T·∫°m bi·ªát</span>
            <p class="ntxt">Bu·ªïi s√°ng cu·ªëi c√πng tr√¥i qua ch·∫≠m r√£i trong s·ª± l∆∞u luy·∫øn kh√≥ g·ªçi t√™n. Dinh III ‚Äì Dinh B·∫£o ƒê·∫°i kh√©p l·∫°i h√†nh tr√¨nh b·∫±ng v·∫ª ƒë·∫πp tr·∫ßm m·∫∑c, c·ªï k√≠nh gi·ªØa r·ª´ng th√¥ng xanh m√°t. Khi b√°nh xe lƒÉn b√°nh, th√†nh ph·ªë d·∫ßn l√πi xa, nh∆∞ng k√Ω ·ª©c th√¨ ·ªü l·∫°i.</p>
          </aside>
        </div>
        
        <blockquote class="quote-box">
          <p class="quote-text">ƒê√≥ l√† m·ªôt ph·∫ßn thanh xu√¢n mang t√™n 11L...</p>
        </blockquote>
      </div>
      <div class="page-number" aria-label="Trang 3 tr√™n 4">~ Trang 3 ~</div>
      <nav class="page-nav" aria-label="ƒêi·ªÅu h∆∞·ªõng gi·ªØa c√°c trang">
        <button class="nav-btn" onclick="turnPage(2)" aria-label="V·ªÅ trang 2">‚Üê Trang tr∆∞·ªõc</button>
        <button class="nav-btn" onclick="turnPage(4)" aria-label="ƒê·∫øn trang 4">Trang sau ‚Üí</button>
      </nav>
    </div>

    <!-- ‚ïê‚ïê PAGE 4 ‚ïê‚ïê -->
    <div class="page" id="page4" style="display:none;" role="main">
      <div class="page-content">
        <div class="dclouds" aria-hidden="true">‚òÅÔ∏è &nbsp;&nbsp; ‚òÅÔ∏è &nbsp;&nbsp;&nbsp; ‚òÅÔ∏è</div>
        <h3 class="section-title">
          <span class="title-icon" aria-hidden="true">üå∏</span>
          <span class="title-text">ƒê√† L·∫°t ‚Äì Mi·ªÅn K√Ω ·ª®c C·ªßa 11L</span>
        </h3>
        
        <div class="cgrid">
          <article class="ccard">
            <figure class="ci">
              <img src="images/final.jpg" alt="To√†n b·ªô h·ªçc sinh l·ªõp 11L t·∫°i ƒê√† L·∫°t" loading="lazy">
            </figure>
            <div class="ct">
              <p>Chuy·∫øn tham quan h·ªçc t·∫≠p t·∫°i ƒê√† L·∫°t kh√¥ng ch·ªâ mang ƒë·∫øn ki·∫øn th·ª©c v√† tr·∫£i nghi·ªám, m√† c√≤n ƒë√°nh d·∫•u m·ªôt ƒëo·∫°n ƒë·∫πp trong h√†nh tr√¨nh tr∆∞·ªüng th√†nh c·ªßa l·ªõp 11L.</p>
              <p>·ªû ƒë√≥, ch√∫ng t√¥i ƒë√£ c√πng nhau h·ªçc c√°ch s·ªëng ch·∫≠m, h·ªçc c√°ch l·∫Øng nghe, h·ªçc c√°ch tr√¢n tr·ªçng hi·ªán t·∫°i v√† h·ªçc c√°ch gi·ªØ g√¨n nh·ªØng ƒëi·ªÅu nh·ªè b√© nh∆∞ng qu√Ω gi√°.</p>
            </div>
          </article>
          
          <article class="ccard">
            <figure class="ci">
              <img src="images/memory.jpg" alt="Nh·ªØng kho·∫£nh kh·∫Øc ƒë√°ng nh·ªõ t·∫°i ƒê√† L·∫°t" loading="lazy">
            </figure>
            <div class="ct">
              <p>Nhi·ªÅu nƒÉm sau, khi nh·ªØng con ƒë∆∞·ªùng ƒë·ªùi ƒë√£ r·∫Ω sang nhi·ªÅu h∆∞·ªõng kh√°c nhau, c√≥ th·ªÉ ch√∫ng t√¥i s·∫Ω qu√™n ƒëi v√†i chi ti·∫øt nh·ªè, nh∆∞ng ch·∫Øc ch·∫Øn ƒê√† L·∫°t v·∫´n c√≤n ·ªü l·∫°i.</p>
              <p>Trong nh·ªØng b·ª©c ·∫£nh c≈©, trong nh·ªØng c√¢u chuy·ªán ƒë∆∞·ª£c k·ªÉ l·∫°i v√† trong m·ªôt g√≥c r·∫•t s√¢u c·ªßa k√Ω ·ª©c tu·ªïi h·ªçc tr√≤ ‚Äì n∆°i r·ª´ng th√¥ng v·∫´n m√£i xanh t∆∞∆°i.</p>
            </div>
          </article>
        </div>
        
        <blockquote class="quote-box">
          <p class="quote-text">
            B·ªüi ƒë√≥ kh√¥ng ch·ªâ l√† m·ªôt chuy·∫øn ƒëi, ƒë√≥ l√† m·ªôt ph·∫ßn thanh xu√¢n, ƒë√≥ l√† mi·ªÅn nh·ªõ mang t√™n l·ªõp 11L üå≤
          </p>
        </blockquote>
        
        <div class="rdiv" aria-hidden="true"><span>üå≤</span><span>‚òÅÔ∏è</span><span>üåø</span></div>
        <div class="sig" aria-label="K·∫øt th√∫c nh·∫≠t k√Ω">üå≤ ~ H·∫øt ~ üå≤</div>
      </div>
      <div class="page-number" aria-label="Trang 4 tr√™n 4">~ Trang 4 ~</div>
      <nav class="page-nav" aria-label="ƒêi·ªÅu h∆∞·ªõng gi·ªØa c√°c trang">
        <button class="nav-btn" onclick="turnPage(3)" aria-label="V·ªÅ trang 3">‚Üê Trang tr∆∞·ªõc</button>
        <button class="nav-btn cover-btn" onclick="closePage()" aria-label="ƒê√≥ng s√°ch">üçÉ ƒê√≥ng s√°ch</button>
      </nav>
    </div>

  </div>
</div>

<div class="image-modal" id="imageModal" role="dialog" aria-modal="true" aria-label="Xem ·∫£nh ph√≥ng to">
  <button class="modal-close" onclick="closeModal()" aria-label="ƒê√≥ng ·∫£nh">√ó</button>
  <img id="modalImg" alt="">
  <div class="modal-caption" id="modalCaption"></div>
</div>
<button class="scroll-top" id="scrollTop" onclick="scrollToTop()" aria-label="Cu·ªôn l√™n ƒë·∫ßu trang">‚Üë</button>

<script>
let currentPage = 1;
let touchStartX = 0;
let touchEndX = 0;

function announce(msg) {
  const el = document.getElementById('srAnnounce');
  el.textContent = '';
  requestAnimationFrame(() => { el.textContent = msg; });
}

function updateBreadcrumb(pageNum) {
  const breadcrumb = document.getElementById('breadcrumb');
  const breadcrumbText = document.getElementById('breadcrumbText');
  if (pageNum === 0) {
    breadcrumbText.textContent = 'B√¨a s√°ch';
    breadcrumb.classList.remove('visible');
  } else {
    const titles = ['Mi·ªÅn K√Ω ·ª®c M·ªü Ra','√ù Nghƒ©a C·ªßa M·ªôt Chuy·∫øn ƒêi','H√†nh Tr√¨nh Ba Ng√†y','ƒê√† L·∫°t ‚Äì Mi·ªÅn K√Ω ·ª®c'];
    breadcrumbText.textContent = `Trang ${pageNum}: ${titles[pageNum - 1]}`;
    breadcrumb.classList.add('visible');
  }
}

function updatePageSelector(pageNum) {
  document.querySelectorAll('.page-select-btn').forEach(btn => {
    const isActive = +btn.dataset.page === pageNum;
    btn.classList.toggle('active', isActive);
    btn.setAttribute('aria-current', isActive ? 'page' : 'false');
  });
}

function animateProgressBar(duration) {
  const container = document.getElementById('progressBarContainer');
  const bar = document.getElementById('progressBar');
  container.classList.add('active');
  bar.style.transition = 'none';
  bar.style.width = '0%';
  requestAnimationFrame(() => {
    bar.style.transition = `width ${duration}ms cubic-bezier(.4,0,.2,1)`;
    bar.style.width = '100%';
    setTimeout(() => {
      container.classList.remove('active');
      bar.style.transition = 'none';
      bar.style.width = '0%';
    }, duration + 80);
  });
}

// Cursor trail ‚Äî RAF-based for smoothness
let mouseX = 0, mouseY = 0;
let lastTrailTime = 0;
document.addEventListener('mousemove', (e) => {
  mouseX = e.clientX; mouseY = e.clientY;
  const now = Date.now();
  if (now - lastTrailTime > 70 && Math.random() > 0.65) {
    lastTrailTime = now;
    const trail = document.createElement('div');
    trail.className = 'cursor-trail';
    trail.style.left = e.clientX + 'px';
    trail.style.top = e.clientY + 'px';
    document.body.appendChild(trail);
    setTimeout(() => trail.remove(), 600);
  }
}, { passive: true });

function buildFireflies(){
  const w=document.getElementById('ffWrap');
  for(let i=0;i<22;i++){
    const f=document.createElement('div'); f.className='ff';
    const sz=2+Math.random()*4;
    const col=Math.random()<.55?`rgba(62,114,73,${.55+Math.random()*.3})`:`rgba(142,200,230,${.45+Math.random()*.3})`;
    f.style.cssText=`width:${sz}px;height:${sz}px;left:${8+Math.random()*84}%;bottom:${5+Math.random()*42}%;background:${col};box-shadow:0 0 ${sz*2.4}px ${col};--dx:${(Math.random()-.5)*75}px;--dur:${3.5+Math.random()*4.5}s;--del:${Math.random()*7}s;`;
    w.appendChild(f);
  }
}

const LEAVES=['üçÉ','üåø','üçÇ','üå±','üçÄ'];
function buildLeaves(id){
  const el=document.getElementById(id); if(!el)return;
  for(let i=0;i<10;i++){
    const l=document.createElement('div'); l.className='lf';
    const sz=10+Math.random()*8,dur=5+Math.random()*6,del=Math.random()*9;
    l.textContent=LEAVES[i%LEAVES.length];
    l.style.cssText=`left:${Math.random()*95}%;bottom:${Math.random()*18}%;--lsz:${sz}px;--ldur:${dur}s;--ldel:${del}s;--lx:${(Math.random()-.5)*90}px;`;
    el.appendChild(l);
  }
}

function syncDots(n){
  document.querySelectorAll('.pdot').forEach(d=>{
    const isActive = +d.dataset.p === n;
    d.classList.toggle('on', isActive);
    d.setAttribute('aria-current', isActive ? 'true' : 'false');
  });
}

document.querySelectorAll('.pdot').forEach(d => {
  d.addEventListener('click', () => turnPage(+d.dataset.p));
  d.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); turnPage(+d.dataset.p); }
  });
});

document.querySelectorAll('.page-select-btn').forEach(btn => {
  btn.addEventListener('click', () => turnPage(+btn.dataset.page));
  btn.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); turnPage(+btn.dataset.page); }
  });
});

document.getElementById('openBookBtn').addEventListener('click', function(e) {
  e.preventDefault(); e.stopPropagation();
  if (this.dataset.processing === 'true') return;
  this.dataset.processing = 'true';

  const cover = document.getElementById('bookCover');
  const pages = document.getElementById('bookPages');
  const page1 = document.getElementById('page1');

  cover.style.transition = 'opacity 0.22s cubic-bezier(.4,0,.2,1), transform 0.22s cubic-bezier(.4,0,.2,1)';
  cover.style.opacity = '0';
  cover.style.transform = 'scale(0.97) translateY(-8px)';

  setTimeout(() => {
    cover.style.display = 'none';
    cover.style.opacity = '';
    cover.style.transform = '';
    cover.style.transition = '';
    pages.style.display = 'block';
    page1.style.display = 'block';
    pages.style.opacity = '0';
    pages.style.transform = 'translateY(10px)';
    pages.style.transition = 'opacity 0.28s cubic-bezier(.22,1,.36,1), transform 0.28s cubic-bezier(.22,1,.36,1)';
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        pages.style.opacity = '1';
        pages.style.transform = 'translateY(0)';
      });
    });
    currentPage = 1;
    syncDots(1);
    updateBreadcrumb(1);
    updatePageSelector(1);
    announce('ƒê√£ m·ªü nh·∫≠t k√Ω. ƒêang ·ªü trang 1: Mi·ªÅn K√Ω ·ª®c M·ªü Ra');
    this.dataset.processing = 'false';
    window.scrollTo({top: 0, behavior: 'smooth'});
    setupScrollAnim();
    setTimeout(() => {
      pages.style.transition = '';
      pages.style.opacity = '';
      pages.style.transform = '';
    }, 300);
  }, 200);
});

function turnPage(n){
  if(n<1||n>4||currentPage===n) return;
  animateProgressBar(280);
  const spinner = document.getElementById('loadingSpinner');
  spinner.classList.add('active');
  setTimeout(()=>{
    document.getElementById('page'+currentPage).style.display='none';
    document.getElementById('page'+n).style.display='block';
    currentPage=n;
    syncDots(n);
    updateBreadcrumb(n);
    updatePageSelector(n);
    const titles = ['Mi·ªÅn K√Ω ·ª®c M·ªü Ra','√ù Nghƒ©a C·ªßa M·ªôt Chuy·∫øn ƒêi','H√†nh Tr√¨nh Ba Ng√†y','ƒê√† L·∫°t ‚Äì Mi·ªÅn K√Ω ·ª®c'];
    announce(`Trang ${n}: ${titles[n-1]}`);
    spinner.classList.remove('active');
    window.scrollTo({top:0,behavior:'smooth'});
    setupScrollAnim();
  },280);
}

function closePage(){
  animateProgressBar(260);
  document.getElementById('loadingSpinner').classList.add('active');
  setTimeout(()=>{
    document.getElementById('bookPages').style.display='none';
    document.getElementById('bookCover').style.display='block';
    document.getElementById('page'+currentPage).style.display='none';
    document.getElementById('loadingSpinner').classList.remove('active');
    updateBreadcrumb(0);
    announce('ƒê√£ ƒë√≥ng nh·∫≠t k√Ω, quay v·ªÅ b√¨a s√°ch');
    window.scrollTo({top:0,behavior:'smooth'});
  },260);
}

document.querySelectorAll('.journey-tab').forEach(tab=>{
  const clickHandler = () => {
    document.querySelectorAll('.journey-tab').forEach(t => {
      t.classList.remove('active');
      t.setAttribute('aria-selected', 'false');
    });
    document.querySelectorAll('.day-content').forEach(c=>c.classList.remove('active'));
    tab.classList.add('active');
    tab.setAttribute('aria-selected', 'true');
    document.getElementById(tab.dataset.day).classList.add('active');
    announce(`ƒêang xem ${tab.textContent.trim()}`);
  };
  tab.addEventListener('click', clickHandler);
  tab.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); clickHandler(); }
  });
});

document.addEventListener('click', e => {
  const arrow = e.target.closest('.aarr');
  if (!arrow) return;
  const album = document.getElementById(arrow.dataset.album);
  const scrollAmount = arrow.classList.contains('ap') ? -340 : 340;
  album.scrollBy({ left: scrollAmount, behavior: 'smooth' });
});

function handleSwipe() {
  const diff = touchStartX - touchEndX;
  if (Math.abs(diff) > 45) {
    if (diff > 0 && currentPage < 4) turnPage(currentPage + 1);
    else if (diff < 0 && currentPage > 1) turnPage(currentPage - 1);
  }
}
document.getElementById('bookPages').addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive:true});
document.getElementById('bookPages').addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; handleSwipe(); }, {passive:true});

document.querySelectorAll('.atrack').forEach(album => {
  let isDown = false, startX, scrollLeft;
  album.addEventListener('mousedown', e => { isDown = true; album.style.cursor = 'grabbing'; startX = e.pageX - album.offsetLeft; scrollLeft = album.scrollLeft; });
  album.addEventListener('mouseleave', () => { isDown = false; album.style.cursor = 'grab'; });
  album.addEventListener('mouseup', () => { isDown = false; album.style.cursor = 'grab'; });
  album.addEventListener('mousemove', e => {
    if (!isDown) return; e.preventDefault();
    const x = e.pageX - album.offsetLeft;
    const walk = (x - startX) * 2.5;
    album.scrollLeft = scrollLeft - walk;
  });
});

// Image modal
const modal=document.getElementById('imageModal'), modalImg=document.getElementById('modalImg');
let allModalImages = [];
let currentModalIndex = 0;

function openModal(img, index, images) {
  allModalImages = images;
  currentModalIndex = index;
  modal.classList.add('active');
  modalImg.src = img.src;
  modalImg.alt = img.alt;
  document.getElementById('modalCaption').textContent = img.alt || '';
  document.body.style.overflow='hidden';
}

function closeModal(){
  modal.classList.remove('active');
  document.body.style.overflow='';
  setTimeout(() => { document.getElementById('modalImg').removeAttribute('src'); }, 320);
}

document.querySelectorAll('.pola img,.story-image img,.ci img').forEach((img, i, arr) => {
  img.addEventListener('click', e => {
    e.stopPropagation();
    openModal(img, i, [...arr]);
  });
});
document.getElementById('imageModal').addEventListener('click', e => { if(e.target===modal) closeModal(); });

document.addEventListener('keydown',e=>{
  if(e.key==='Escape') closeModal();
  if(!modal.classList.contains('active')) {
    if(document.getElementById('bookPages').style.display!=='block') return;
    if(e.key==='ArrowRight'&&currentPage<4) turnPage(currentPage+1);
    if(e.key==='ArrowLeft'&&currentPage>1) turnPage(currentPage-1);
  }
});

document.querySelectorAll('.story-card').forEach(card => {
  card.addEventListener('mousemove', e => {
    const rect = card.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    card.style.setProperty('--mouse-x', x + '%');
    card.style.setProperty('--mouse-y', y + '%');
  });
});

const scrollTopBtn=document.getElementById('scrollTop');
window.addEventListener('scroll',()=>{ scrollTopBtn.classList.toggle('visible',window.scrollY>300); }, {passive:true});
function scrollToTop(){ window.scrollTo({top:0,behavior:'smooth'}); }

// ‚îÄ‚îÄ SCROLL-IN ANIMATION: fade in khi scroll ƒë·∫øn ‚îÄ‚îÄ
const ANIM_SELECTOR = '.story-card, .meaning-card, .pola, .dnote, .quote-box, .callout, .ccard';

function setupScrollAnim() {
  // L·∫•y t·∫•t c·∫£ element trong trang hi·ªán t·∫°i
  const targets = document.querySelectorAll('#page' + currentPage + ' ' + ANIM_SELECTOR);

  // ·∫®n ngay t·∫•t c·∫£ tr∆∞·ªõc ‚Äî synchronous ƒë·ªÉ kh√¥ng flash
  targets.forEach(el => {
    el.classList.remove('in-view');
    el.classList.add('will-animate');
  });

  // Observe t·ª´ng element, reveal khi scroll ƒë·∫øn
  const obs = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        const el = e.target;
        const allTargets = Array.from(document.querySelectorAll('#page' + currentPage + ' ' + ANIM_SELECTOR));
        const idx = allTargets.indexOf(el);
        setTimeout(() => {
          el.classList.add('in-view');
        }, idx * 80);
        obs.unobserve(el);
      }
    });
  }, {
    threshold: 0.1,
    rootMargin: '0px 0px -40px 0px'
  });

  targets.forEach(el => obs.observe(el));
}

function handleImageLoad(img) {
  if (img.complete && img.naturalWidth > 0) {
    img.classList.add('loaded');
  } else {
    img.addEventListener('load', () => img.classList.add('loaded'));
    img.addEventListener('error', () => { img.style.opacity = '.3'; img.classList.add('loaded'); });
  }
}

window.addEventListener('load',()=>{
  buildFireflies();
  buildLeaves('lf1');
  buildLeaves('lf3');

  document.querySelectorAll('img').forEach(img => handleImageLoad(img));

  if ('IntersectionObserver' in window) {
    const imgObs = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          if (img.dataset.src) { img.src = img.dataset.src; delete img.dataset.src; }
          imgObs.unobserve(img);
        }
      });
    }, { rootMargin: '200px' });
    document.querySelectorAll('img[loading="lazy"]').forEach(img => imgObs.observe(img));
  }

  // Dot pulse every 3s
  const dots = document.querySelectorAll('.pdot');
  setInterval(() => {
    dots.forEach(dot => {
      if(dot.classList.contains('on')) {
        dot.style.transform = 'scale(1.18)';
        setTimeout(() => dot.style.transform = '', 280);
      }
    });
  }, 3000);
});
</script>
</body>
</html>
